{{ $notes := where .Site.RegularPages "Section" "notes" }}
{{ $quotes := where .Site.RegularPages "Section" "quotes" }}

{{ with $notes }}
<section class="activity-feed">
  <h2>Recently updated notes</h2>
  <ul>
    {{/* Show 10 most recently updated notes */}}
    {{ range (sort . "Lastmod" "desc" | first 10) }}
    <li>
      <a href="{{ .RelPermalink }}">{{ .Title | markdownify }}</a>
      {{ if not .Lastmod.IsZero }}
      <span class="feed-date">
        <time datetime="{{ .Lastmod.Format "2006-01-02" }}">{{ .Lastmod.Format "Jan 2, 2006" }}</time>
      </span>
      {{ end }}
    </li>
    {{ end }}
  </ul>
</section>
{{ end }}

{{ with $quotes }}
<section class="activity-feed">
  <h2>Recent quotes</h2>
  <ul>
    {{/* Show 5 most recently added quotes (fewer than notes since quotes are shorter) */}}
    {{ range (sort . "Date" "desc" | first 5) }}
    <li>
      {{ $quote := . }}
      {{ with .Params.work }}
        {{/* Params.work is a slug matching a page under /works/ (bibliographic entries) */}}
        {{ $work := $.Site.GetPage (printf "/works/%s" .) }}
        <a href="{{ $quote.RelPermalink }}">{{ with $work }}{{ .Params.author }}{{ else }}{{ $quote.Title }}{{ end }}</a>
      {{ else }}
        <a href="{{ .RelPermalink }}">{{ .Title | safeHTML }}</a>
      {{ end }}
      <span class="feed-date">
        <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "Jan 2, 2006" }}</time>
      </span>
    </li>
    {{ end }}
  </ul>
</section>
{{ end }}
